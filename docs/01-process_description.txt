    Верстка файлов под Indigo WS 6000


	Задачи: автоматизировать процесс верстки файлов.

	Цели: освободить немного времени для более творческих задач.

	_________________________


	Автоматизировать процесс верстки планируется с помощью javascript.

	Идельная программа видится мне так:

	Верстальщик запускает скрипт make_collection. В окне диалога указывается номер паспорта, номер высекательного штампа (шаблона). Скрипт производит верстку файлов и выдает сообщение о завершении процесса.

	_________________________

	Реализация:

	Перед запуском скрипта верстальщик формирует текстовой файл с нумерованным списком имен файлов этикеток (print_list). Этот файл может находиться в папке паспорта или на локальном диске верстальщика.

	На локальном диске верстальщика (в папке D:\template) находятся также шаблоны сборок.
	Шаблоны - это файлы в формате *.ai. Имя файла-шаблона состоит из 7-8 целых чисел. Структура файлов-шаблонов одинаковая. Файл содержит три слоя: mark (метки), cut (высечки) и безымянный слой <Layer> (этикетки). В шаблоне имеется графический стиль для размещения массива этикеток.

	Скрипт открывает в Illustrator файл шаблона, помещает из указанного паспорта этикетку №1 на слой <Layer>, выравнивает ее по самому нижнему элементу слоя cut и применяет к этикетке (place-объекту) графический стиль. Затем сохраняет файл сборки в указанном паспорте в формате *.pdf со следующим синтаксисом: [номер паспорта]_[порядковый номер этикетки]_[имя файла этикетки].

	Процедура повторяется для всех этикеток из списка (print_list).

/* domelaz

Пример псевдокода:

	получить ссылку на файл шаблона (template.ai);
	загрузить файл print_list;
	для всех этикеток из списка (print_list):
		создать документ на основе файла шаблона (template.ai);
		получить ссылку на слой cut файла шаблона;
			найти самый нижний элемент слоя cut;
			сохранить координаты самого нижнего элемента слоя cut;
		получить ссылку на слой Layer файла шаблона;
			поместить очередную этикетку из списка print_list на слой Layer файла шаблона;
			позиционировать этикетку по сохраненным координатам элемента из слоя cuts;
			применить стиль к этикетке;
		создать имя файла сборки ([номер паспорта]_[порядковый номер этикетки]_[имя файла этикетки]);
		экспортировать сборку с указанным именем файла в формате pdf;
		закрыть файл шаблона без сохранения;
	следующий цикл (print_list);
*/
