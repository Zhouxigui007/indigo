    Верстка файлов под Indigo WS 6000


	Задачи: автоматизировать процесс верстки файлов.

	Цели: освободить немного времени для более творческих задач.

	_________________________


	Автоматизировать процесс верстки планируется с помощью javascript.

	Идельная программа видится мне так:

	Верстальщик запускает скрипт make_collection. В окне диалога указывается номер паспорта, номер высекательного штампа (шаблона). Скрипт производит верстку файлов и выдает сообщение о завершении процесса.

	_________________________

	Реализация:

	Перед запуском скрипта верстальщик формирует текстовой файл с нумерованным списком имен файлов этикеток (print_list). Этот файл может находиться в папке паспорта или на локальном диске верстальщика.

	На локальном диске верстальщика (в папке D:\template) находятся также шаблоны сборок.
	Шаблоны - это файлы в формате *.ai. Имя файла-шаблона состоит из 7-8 целых чисел. Структура файлов-шаблонов одинаковая. Файл содержит три слоя: mark (метки), cut (высечки) и безымянный слой <Layer> (этикетки). В шаблоне имеется графический стиль для размещения массива этикеток.

	Скрипт открывает в Illustrator файл шаблона, помещает из указанного паспорта этикетку №1 на слой <Layer>, выравнивает ее по самому нижнему элементу слоя cut и применяет к этикетке (place-объекту) графический стиль. Затем сохраняет файл сборки в указанном паспорте в формате *.pdf со следующим синтаксисом: [номер паспорта]_[порядковый номер этикетки]_[имя файла этикетки].

	Процедура повторяется для всех этикеток из списка (print_list).

/* domelaz

Пример псевдокода:

1. создать окно диалога с двумя полями для ввода данных: номер паспорта ($task) и шаблон сборки ($template).

2. открыть шаблон сборки (файл $template.ai из папки template);

3. считать массив этикеток из файла print_list.csv ($number и $label);

4. найти самый нижний элемент слоя cut и сохранить его координаты ($x и $y position);

	5. получить ссылку на слой Layer файла шаблона;

	6. получить ссылку на коллекцию графических стилей в шаблоне;

	7. выбрать графический стиль, который будет применяться к этикетке;

8. создать стиль_pdf для экспорта спуска;

9. Цикл (для всех этикеток из списка $print_list):

	9.1. поместить очередную этикетку из списка print_list на слой Layer файла шаблона;
	9.2. позиционировать этикетку по координатам элемента ($x и $y position) из слоя cuts;
	9.3. применить стиль к этикетке;
	9.4. создать имя файла сборки ($name = $task_$number_$label);
	9.5. экспортировать сборку с указанным $name в стиле_pdf;
	9.6. удалить содержимое слоя Layer;

повторить цикл $number количество раз (print_list);

10. закрыть файл шаблона без сохранения;
*/
