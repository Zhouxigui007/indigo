sender: bridge-2.0
target: illustrator-13.0-ru_ru
timeout: 600
type: ExtendScript
body: /*
 * Dispatch relations between Illustrator And Bridge
 */
BridgeTalk.onReceive = function (message) {
	$.writeln('Dispatch 6 Here');
	serializeMessage(message);
	job = eval(message.headers.job);
	result = $.evalFile('/w/bin/Run.jsx');
	// BridgeTalk want's this:
	result.toSource();
}

/**
 * Helper Test function
 * Serialize and save BridgeTalkMessage object
 */
function serializeMessage(message) {
	$.writeln('serializeMessage 9 Here');
	var msgOutput = new File('/w/bin/tests/message.jsn');
	msgOutput.open('w');
	for (var mp in message) {
		if (message.hasOwnProperty(mp)) {
			$.writeln(mp);
			msgOutput.writeln(mp + ': ' + message[mp]);
		}
	}
	
	msgOutput.writeln(message.headers.toSource());
	msgOutput.close();
}

headers: [object BridgeTalkHeaders]
